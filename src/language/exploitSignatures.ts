export interface ExploitFunction {
    name: string;
    signature: string;
    description: string;
    returns: string;
    category: string;
    examples?: string[];
}

export const exploitFunctions: ExploitFunction[] = [
    // Environment Functions
    {
        name: 'getgenv',
        signature: 'getgenv(): table',
        description: 'Returns the global environment table for the exploit',
        returns: 'table - The global exploit environment',
        category: 'Environment',
        examples: [
            'getgenv().MyGlobal = "value"',
            'local env = getgenv()'
        ]
    },
    {
        name: 'getrenv',
        signature: 'getrenv(): table',
        description: 'Returns the Roblox global environment',
        returns: 'table - The Roblox environment',
        category: 'Environment',
        examples: ['local renv = getrenv()']
    },
    {
        name: 'getfenv',
        signature: 'getfenv(level: number | function): table',
        description: 'Returns the environment of a function or stack level',
        returns: 'table - The function environment',
        category: 'Environment',
        examples: [
            'local env = getfenv(1)',
            'local env = getfenv(someFunction)'
        ]
    },
    {
        name: 'setfenv',
        signature: 'setfenv(level: number | function, env: table): function',
        description: 'Sets the environment of a function or stack level',
        returns: 'function - The function with updated environment',
        category: 'Environment',
        examples: ['setfenv(1, {})']
    },

    // Hooking Functions
    {
        name: 'hookfunction',
        signature: 'hookfunction(target: function, hook: function): function',
        description: 'Hooks a function, replacing it with a custom implementation. Returns the original function.',
        returns: 'function - The original function before hooking',
        category: 'Hooking',
        examples: [
            'local old = hookfunction(print, function(...) return old("Hooked:", ...) end)'
        ]
    },
    {
        name: 'hookmetamethod',
        signature: 'hookmetamethod(object: userdata, method: string, hook: function): function',
        description: 'Hooks a metamethod of an object. Returns the original metamethod.',
        returns: 'function - The original metamethod',
        category: 'Hooking',
        examples: [
            'local old = hookmetamethod(game, "__namecall", function(self, ...) return old(self, ...) end)'
        ]
    },

    // Script Functions
    {
        name: 'getsenv',
        signature: 'getsenv(script: Instance): table',
        description: 'Returns the environment table of a script',
        returns: 'table - The script environment',
        category: 'Script',
        examples: ['local env = getsenv(game.Players.LocalPlayer.PlayerScripts.Script)']
    },
    {
        name: 'getcallingscript',
        signature: 'getcallingscript(): Instance?',
        description: 'Returns the script that called the current function',
        returns: 'Instance? - The calling script or nil',
        category: 'Script',
        examples: ['local caller = getcallingscript()']
    },
    {
        name: 'getscriptclosure',
        signature: 'getscriptclosure(script: Instance): function',
        description: 'Returns the main function of a script',
        returns: 'function - The script\'s main function',
        category: 'Script',
        examples: ['local func = getscriptclosure(script)']
    },
    {
        name: 'getscripthash',
        signature: 'getscripthash(script: Instance): string',
        description: 'Returns the hash of a script',
        returns: 'string - The script hash',
        category: 'Script',
        examples: ['local hash = getscripthash(script)']
    },
    {
        name: 'getscriptbytecode',
        signature: 'getscriptbytecode(script: Instance): string',
        description: 'Returns the bytecode of a script',
        returns: 'string - The script bytecode',
        category: 'Script',
        examples: ['local bytecode = getscriptbytecode(script)']
    },

    // Instance Functions
    {
        name: 'getnilinstances',
        signature: 'getnilinstances(): {Instance}',
        description: 'Returns all instances with nil parent',
        returns: '{Instance} - Array of nil instances',
        category: 'Instance',
        examples: ['local nilInstances = getnilinstances()']
    },
    {
        name: 'getinstances',
        signature: 'getinstances(): {Instance}',
        description: 'Returns all instances in the game',
        returns: '{Instance} - Array of all instances',
        category: 'Instance',
        examples: ['local allInstances = getinstances()']
    },
    {
        name: 'fireclickdetector',
        signature: 'fireclickdetector(detector: ClickDetector, distance: number?): void',
        description: 'Fires a ClickDetector',
        returns: 'void',
        category: 'Instance',
        examples: ['fireclickdetector(workspace.Part.ClickDetector)']
    },
    {
        name: 'fireproximityprompt',
        signature: 'fireproximityprompt(prompt: ProximityPrompt): void',
        description: 'Fires a ProximityPrompt',
        returns: 'void',
        category: 'Instance',
        examples: ['fireproximityprompt(workspace.Part.ProximityPrompt)']
    },

    // Metatable Functions
    {
        name: 'getrawmetatable',
        signature: 'getrawmetatable(object: any): table?',
        description: 'Returns the raw metatable of an object, bypassing __metatable',
        returns: 'table? - The metatable or nil',
        category: 'Metatable',
        examples: ['local mt = getrawmetatable(game)']
    },
    {
        name: 'setrawmetatable',
        signature: 'setrawmetatable(object: any, metatable: table): void',
        description: 'Sets the raw metatable of an object, bypassing protections',
        returns: 'void',
        category: 'Metatable',
        examples: ['setrawmetatable(game, {})']
    },
    {
        name: 'setreadonly',
        signature: 'setreadonly(table: table, readonly: boolean): void',
        description: 'Sets whether a table is read-only',
        returns: 'void',
        category: 'Metatable',
        examples: [
            'setreadonly(table, false)',
            'setreadonly(getrawmetatable(game), false)'
        ]
    },
    {
        name: 'isreadonly',
        signature: 'isreadonly(table: table): boolean',
        description: 'Checks if a table is read-only',
        returns: 'boolean - True if read-only',
        category: 'Metatable',
        examples: ['local readonly = isreadonly(table)']
    },

    // Closure Functions
    {
        name: 'islclosure',
        signature: 'islclosure(func: function): boolean',
        description: 'Checks if a function is a Lua closure',
        returns: 'boolean - True if Lua closure',
        category: 'Closure',
        examples: ['local isLua = islclosure(function() end)']
    },
    {
        name: 'iscclosure',
        signature: 'iscclosure(func: function): boolean',
        description: 'Checks if a function is a C closure',
        returns: 'boolean - True if C closure',
        category: 'Closure',
        examples: ['local isC = iscclosure(print)']
    },
    {
        name: 'newcclosure',
        signature: 'newcclosure(func: function): function',
        description: 'Wraps a Lua function as a C closure',
        returns: 'function - The wrapped function',
        category: 'Closure',
        examples: ['local wrapped = newcclosure(function() end)']
    },
    {
        name: 'checkcaller',
        signature: 'checkcaller(): boolean',
        description: 'Checks if the current thread is from the executor',
        returns: 'boolean - True if executor thread',
        category: 'Closure',
        examples: ['if checkcaller() then print("Executor thread") end']
    },

    // Utility Functions
    {
        name: 'setclipboard',
        signature: 'setclipboard(content: string): void',
        description: 'Sets the clipboard content',
        returns: 'void',
        category: 'Utility',
        examples: ['setclipboard("Hello, World!")']
    },
    {
        name: 'setfflag',
        signature: 'setfflag(flag: string, value: string): void',
        description: 'Sets a FFlag value',
        returns: 'void',
        category: 'Utility',
        examples: ['setfflag("FlagName", "true")']
    },
    {
        name: 'getfflag',
        signature: 'getfflag(flag: string): string',
        description: 'Gets a FFlag value',
        returns: 'string - The flag value',
        category: 'Utility',
        examples: ['local value = getfflag("FlagName")']
    },

    // File System Functions
    {
        name: 'readfile',
        signature: 'readfile(path: string): string',
        description: 'Reads a file from the workspace folder',
        returns: 'string - The file contents',
        category: 'Filesystem',
        examples: ['local content = readfile("config.txt")']
    },
    {
        name: 'writefile',
        signature: 'writefile(path: string, content: string): void',
        description: 'Writes content to a file',
        returns: 'void',
        category: 'Filesystem',
        examples: ['writefile("data.txt", "Hello")']
    },
    {
        name: 'appendfile',
        signature: 'appendfile(path: string, content: string): void',
        description: 'Appends content to a file',
        returns: 'void',
        category: 'Filesystem',
        examples: ['appendfile("log.txt", "New entry\\n")']
    },
    {
        name: 'isfile',
        signature: 'isfile(path: string): boolean',
        description: 'Checks if a file exists',
        returns: 'boolean - True if file exists',
        category: 'Filesystem',
        examples: ['if isfile("config.txt") then readfile("config.txt") end']
    },
    {
        name: 'isfolder',
        signature: 'isfolder(path: string): boolean',
        description: 'Checks if a folder exists',
        returns: 'boolean - True if folder exists',
        category: 'Filesystem',
        examples: ['if isfolder("data") then print("Folder exists") end']
    },
    {
        name: 'makefolder',
        signature: 'makefolder(path: string): void',
        description: 'Creates a folder',
        returns: 'void',
        category: 'Filesystem',
        examples: ['makefolder("data")']
    },
    {
        name: 'listfiles',
        signature: 'listfiles(path: string): {string}',
        description: 'Lists all files in a folder',
        returns: '{string} - Array of file paths',
        category: 'Filesystem',
        examples: ['local files = listfiles("data")']
    },
    {
        name: 'delfile',
        signature: 'delfile(path: string): void',
        description: 'Deletes a file',
        returns: 'void',
        category: 'Filesystem',
        examples: ['delfile("temp.txt")']
    },
    {
        name: 'delfolder',
        signature: 'delfolder(path: string): void',
        description: 'Deletes a folder',
        returns: 'void',
        category: 'Filesystem',
        examples: ['delfolder("temp")']
    },

    // Network Functions
    {
        name: 'request',
        signature: 'request(options: {Url: string, Method: string?, Headers: table?, Body: string?}): {Success: boolean, StatusCode: number, Body: string, Headers: table}',
        description: 'Makes an HTTP request',
        returns: 'table - Response with Success, StatusCode, Body, and Headers',
        category: 'Network',
        examples: [
            'local response = request({Url = "https://api.example.com", Method = "GET"})'
        ]
    },
    {
        name: 'http_request',
        signature: 'http_request(options: table): table',
        description: 'Alias for request function',
        returns: 'table - HTTP response',
        category: 'Network',
        examples: ['local response = http_request({Url = "https://example.com"})']
    },

    // Debug Functions
    {
        name: 'getinfo',
        signature: 'getinfo(func: function | number): table',
        description: 'Returns debug info about a function',
        returns: 'table - Debug information',
        category: 'Debug',
        examples: ['local info = getinfo(print)']
    },
    {
        name: 'getconstants',
        signature: 'getconstants(func: function): {any}',
        description: 'Returns all constants in a function',
        returns: '{any} - Array of constants',
        category: 'Debug',
        examples: ['local constants = getconstants(func)']
    },
    {
        name: 'getupvalues',
        signature: 'getupvalues(func: function): {any}',
        description: 'Returns all upvalues of a function',
        returns: '{any} - Array of upvalues',
        category: 'Debug',
        examples: ['local upvalues = getupvalues(func)']
    },
    {
        name: 'getconnections',
        signature: 'getconnections(signal: RBXScriptSignal): {Connection}',
        description: 'Returns all connections to a signal',
        returns: '{Connection} - Array of connections',
        category: 'Debug',
        examples: ['local connections = getconnections(workspace.ChildAdded)']
    },

    // Identity Functions
    {
        name: 'getidentity',
        signature: 'getidentity(): number',
        description: 'Returns the current thread identity level',
        returns: 'number - Thread identity (0-8)',
        category: 'Identity',
        examples: ['local identity = getidentity()']
    },
    {
        name: 'setidentity',
        signature: 'setidentity(identity: number): void',
        description: 'Sets the current thread identity level',
        returns: 'void',
        category: 'Identity',
        examples: ['setidentity(8)']
    },
    {
        name: 'getthreadidentity',
        signature: 'getthreadidentity(): number',
        description: 'Alias for getidentity',
        returns: 'number - Thread identity',
        category: 'Identity',
        examples: ['local identity = getthreadidentity()']
    },
    {
        name: 'setthreadidentity',
        signature: 'setthreadidentity(identity: number): void',
        description: 'Alias for setidentity',
        returns: 'void',
        category: 'Identity',
        examples: ['setthreadidentity(7)']
    },

    // Misc Functions
    {
        name: 'loadstring',
        signature: 'loadstring(source: string, chunkname: string?): function?',
        description: 'Loads a string as Lua code and returns a function',
        returns: 'function? - Compiled function or nil on error',
        category: 'Misc',
        examples: [
            'local func = loadstring("print(\\"Hello\\")")',
            'func()'
        ]
    },
    {
        name: 'decompile',
        signature: 'decompile(script: Instance): string',
        description: 'Decompiles a script to Luau source code',
        returns: 'string - Decompiled source',
        category: 'Misc',
        examples: ['local source = decompile(script)']
    },
    {
        name: 'saveinstance',
        signature: 'saveinstance(options: table?): void',
        description: 'Saves the game instance to a file',
        returns: 'void',
        category: 'Misc',
        examples: ['saveinstance()']
    },
    {
        name: 'getnamecallmethod',
        signature: 'getnamecallmethod(): string',
        description: 'Returns the method name from a __namecall metamethod',
        returns: 'string - The method name',
        category: 'Misc',
        examples: [
            'local old = hookmetamethod(game, "__namecall", function(self, ...) print(getnamecallmethod()) return old(self, ...) end)'
        ]
    },
    {
        name: 'identifyexecutor',
        signature: 'identifyexecutor(): string',
        description: 'Returns the name of the executor',
        returns: 'string - Executor name',
        category: 'Misc',
        examples: ['local executor = identifyexecutor()']
    },

    // WebSocket Functions
    {
        name: 'WebSocket',
        signature: 'WebSocket.connect(url: string): WebSocket',
        description: 'Creates a WebSocket connection to the specified URL',
        returns: 'WebSocket - WebSocket connection object with Send(), Close() methods and OnMessage, OnClose events',
        category: 'Network',
        examples: [
            'local ws = WebSocket.connect("ws://localhost:9999")',
            'ws.OnMessage:Connect(function(msg) print(msg) end)',
            'ws:Send("Hello")'
        ]
    },

    // Cache Functions
    {
        name: 'cloneref',
        signature: 'cloneref(object: Instance): Instance',
        description: 'Returns a copy of the Instance reference',
        returns: 'Instance - Cloned reference to the same underlying Instance',
        category: 'Cache',
        examples: ['local clonedGame = cloneref(game)']
    },
    {
        name: 'compareinstances',
        signature: 'compareinstances(a: Instance, b: Instance): boolean',
        description: 'Returns whether objects a and b both reference the same Instance',
        returns: 'boolean - True if both references point to the same Instance',
        category: 'Cache',
        examples: ['local isSame = compareinstances(game, cloneref(game))']
    },

    // Crypt Functions
    {
        name: 'crypt.base64encode',
        signature: 'crypt.base64encode(data: string): string',
        description: 'Encodes a string of bytes into Base64',
        returns: 'string - Base64 encoded string',
        category: 'Crypt',
        examples: ['local encoded = crypt.base64encode("Hello, World!")']
    },
    {
        name: 'crypt.base64decode',
        signature: 'crypt.base64decode(data: string): string',
        description: 'Decodes a Base64 string to a string of bytes',
        returns: 'string - Decoded bytes',
        category: 'Crypt',
        examples: ['local decoded = crypt.base64decode(encoded)']
    },
    {
        name: 'crypt.encrypt',
        signature: 'crypt.encrypt(data: string, key: string, iv?: string, mode?: string): string',
        description: 'Encrypts data using AES. Returns encrypted base64 string and IV. Modes: CBC (default), ECB, CTR, CFB, OFB, GCM',
        returns: 'string - Base64 encoded encrypted data',
        category: 'Crypt',
        examples: [
            'local encrypted = crypt.encrypt("data", crypt.generatekey())',
            'local encrypted = crypt.encrypt("data", key, nil, "CBC")'
        ]
    },
    {
        name: 'crypt.decrypt',
        signature: 'crypt.decrypt(data: string, key: string, iv: string, mode?: string): string',
        description: 'Decrypts AES encrypted base64 data',
        returns: 'string - Decrypted data',
        category: 'Crypt',
        examples: ['local decrypted = crypt.decrypt(encrypted, key, iv)']
    },
    {
        name: 'crypt.generatekey',
        signature: 'crypt.generatekey(): string',
        description: 'Generates a base64 encoded 256-bit encryption key',
        returns: 'string - Base64 encoded key',
        category: 'Crypt',
        examples: ['local key = crypt.generatekey()']
    },
    {
        name: 'crypt.generatebytes',
        signature: 'crypt.generatebytes(size: number): string',
        description: 'Generates a random sequence of bytes of the given size',
        returns: 'string - Random bytes',
        category: 'Crypt',
        examples: ['local randomBytes = crypt.generatebytes(16)']
    },
    {
        name: 'crypt.hash',
        signature: 'crypt.hash(data: string, algorithm: string): string',
        description: 'Hashes data using the specified algorithm. Algorithms: MD5, SHA1, SHA256, SHA384, SHA512, SHA3-224, SHA3-256, SHA3-512',
        returns: 'string - Hash result',
        category: 'Crypt',
        examples: [
            'local hash = crypt.hash("data", "SHA256")',
            'local md5 = crypt.hash("password", "MD5")'
        ]
    },

    // Console Functions
    {
        name: 'rconsolecreate',
        signature: 'rconsolecreate(): void',
        description: 'Opens the console window',
        returns: 'void',
        category: 'Console',
        examples: ['rconsolecreate()']
    },
    {
        name: 'rconsoledestroy',
        signature: 'rconsoledestroy(): void',
        description: 'Closes the console window and clears its output',
        returns: 'void',
        category: 'Console',
        examples: ['rconsoledestroy()']
    },
    {
        name: 'rconsoleclear',
        signature: 'rconsoleclear(): void',
        description: 'Removes all text from the console display',
        returns: 'void',
        category: 'Console',
        examples: ['rconsoleclear()']
    },
    {
        name: 'rconsoleprint',
        signature: 'rconsoleprint(text: string): void',
        description: 'Prints text to the console window',
        returns: 'void',
        category: 'Console',
        examples: ['rconsoleprint("Hello, World!")']
    },
    {
        name: 'rconsoleinput',
        signature: 'rconsoleinput(): string',
        description: 'Waits for the user to input text into the console window. Returns the result.',
        returns: 'string - User input',
        category: 'Console',
        examples: ['local input = rconsoleinput()']
    },
    {
        name: 'rconsolesettitle',
        signature: 'rconsolesettitle(title: string): void',
        description: 'Sets the title of the console window',
        returns: 'void',
        category: 'Console',
        examples: ['rconsolesettitle("My Script Console")']
    },

    // Drawing Functions
    {
        name: 'Drawing',
        signature: 'Drawing.new(type: string): Drawing',
        description: 'Creates a new drawing object. Types: Line, Text, Image, Circle, Square, Quad, Triangle',
        returns: 'Drawing - New drawing object',
        category: 'Drawing',
        examples: [
            'local line = Drawing.new("Line")',
            'local circle = Drawing.new("Circle")',
            'local text = Drawing.new("Text")'
        ]
    },
    {
        name: 'cleardrawcache',
        signature: 'cleardrawcache(): void',
        description: 'Destroys all drawing objects',
        returns: 'void',
        category: 'Drawing',
        examples: ['cleardrawcache()']
    },
    {
        name: 'getrenderproperty',
        signature: 'getrenderproperty(drawing: Drawing, property: string): any',
        description: 'Retrieves a property value from a drawing object',
        returns: 'any - Property value',
        category: 'Drawing',
        examples: ['local color = getrenderproperty(drawing, "Color")']
    },
    {
        name: 'setrenderproperty',
        signature: 'setrenderproperty(drawing: Drawing, property: string, value: any): void',
        description: 'Modifies a property of a drawing object',
        returns: 'void',
        category: 'Drawing',
        examples: ['setrenderproperty(drawing, "Visible", true)']
    },
    {
        name: 'isrenderobj',
        signature: 'isrenderobj(object: any): boolean',
        description: 'Checks if an object is a Drawing object',
        returns: 'boolean - True if object is a Drawing',
        category: 'Drawing',
        examples: ['local isDrawing = isrenderobj(obj)']
    },

    // Input Functions
    {
        name: 'isrbxactive',
        signature: 'isrbxactive(): boolean',
        description: 'Checks if the game window has focus',
        returns: 'boolean - True if game window is active',
        category: 'Input',
        examples: ['if isrbxactive() then mouse1click() end']
    },
    {
        name: 'mouse1click',
        signature: 'mouse1click(): void',
        description: 'Dispatches a left mouse button click',
        returns: 'void',
        category: 'Input',
        examples: ['mouse1click()']
    },
    {
        name: 'mouse2click',
        signature: 'mouse2click(): void',
        description: 'Dispatches a right mouse button click',
        returns: 'void',
        category: 'Input',
        examples: ['mouse2click()']
    },
    {
        name: 'mouse1press',
        signature: 'mouse1press(): void',
        description: 'Presses the left mouse button',
        returns: 'void',
        category: 'Input',
        examples: ['mouse1press()']
    },
    {
        name: 'mouse1release',
        signature: 'mouse1release(): void',
        description: 'Releases the left mouse button',
        returns: 'void',
        category: 'Input',
        examples: ['mouse1release()']
    },
    {
        name: 'mouse2press',
        signature: 'mouse2press(): void',
        description: 'Presses the right mouse button',
        returns: 'void',
        category: 'Input',
        examples: ['mouse2press()']
    },
    {
        name: 'mouse2release',
        signature: 'mouse2release(): void',
        description: 'Releases the right mouse button',
        returns: 'void',
        category: 'Input',
        examples: ['mouse2release()']
    },
    {
        name: 'mousemoveabs',
        signature: 'mousemoveabs(x: number, y: number): void',
        description: 'Moves the mouse cursor to the specified absolute position',
        returns: 'void',
        category: 'Input',
        examples: ['mousemoveabs(500, 300)']
    },
    {
        name: 'mousemoverel',
        signature: 'mousemoverel(x: number, y: number): void',
        description: 'Adjusts the mouse cursor by the specified relative amount',
        returns: 'void',
        category: 'Input',
        examples: ['mousemoverel(10, -5)']
    },
    {
        name: 'mousescroll',
        signature: 'mousescroll(pixels: number): void',
        description: 'Dispatches a mouse scroll by the specified number of pixels',
        returns: 'void',
        category: 'Input',
        examples: ['mousescroll(120)']
    },

    // Additional Instance Functions
    {
        name: 'gethiddenproperty',
        signature: 'gethiddenproperty(instance: Instance, property: string): any',
        description: 'Returns the value of a hidden property',
        returns: 'any - Property value',
        category: 'Instance',
        examples: ['local value = gethiddenproperty(part, "HiddenProperty")']
    },
    {
        name: 'sethiddenproperty',
        signature: 'sethiddenproperty(instance: Instance, property: string, value: any): void',
        description: 'Sets the value of a hidden property',
        returns: 'void',
        category: 'Instance',
        examples: ['sethiddenproperty(part, "HiddenProperty", value)']
    },
    {
        name: 'gethui',
        signature: 'gethui(): Instance',
        description: 'Returns a hidden GUI container for detection evasion',
        returns: 'Instance - Hidden GUI container',
        category: 'Instance',
        examples: ['local hiddenGui = gethui()']
    },
    {
        name: 'getcustomasset',
        signature: 'getcustomasset(path: string, cache?: boolean): string',
        description: 'Converts a local file path to an rbxasset:// content ID',
        returns: 'string - Content ID',
        category: 'Instance',
        examples: ['local assetId = getcustomasset("image.png")']
    },
    {
        name: 'isscriptable',
        signature: 'isscriptable(instance: Instance, property: string): boolean',
        description: 'Checks if a property can be scripted',
        returns: 'boolean - True if scriptable',
        category: 'Instance',
        examples: ['local canScript = isscriptable(part, "Size")']
    },
    {
        name: 'setscriptable',
        signature: 'setscriptable(instance: Instance, property: string, scriptable: boolean): void',
        description: 'Controls whether a property can be accessed through scripting',
        returns: 'void',
        category: 'Instance',
        examples: ['setscriptable(part, "Size", true)']
    },
    {
        name: 'getcallbackvalue',
        signature: 'getcallbackvalue(instance: Instance, property: string): function',
        description: 'Retrieves functions assigned to callback properties',
        returns: 'function - Callback function',
        category: 'Instance',
        examples: ['local callback = getcallbackvalue(bindable, "OnInvoke")']
    },

    // Additional Script Functions
    {
        name: 'getloadedmodules',
        signature: 'getloadedmodules(excludeCore?: boolean): {Instance}',
        description: 'Returns a list of loaded ModuleScripts',
        returns: '{Instance} - Array of ModuleScripts',
        category: 'Script',
        examples: ['local modules = getloadedmodules()']
    },
    {
        name: 'getrunningscripts',
        signature: 'getrunningscripts(): {Instance}',
        description: 'Returns all currently running LocalScripts and ModuleScripts',
        returns: '{Instance} - Array of running scripts',
        category: 'Script',
        examples: ['local running = getrunningscripts()']
    },
    {
        name: 'getscripts',
        signature: 'getscripts(): {Instance}',
        description: 'Returns all scripts in the game',
        returns: '{Instance} - Array of all scripts',
        category: 'Script',
        examples: ['local allScripts = getscripts()']
    },
    {
        name: 'getgc',
        signature: 'getgc(includeTables?: boolean): {any}',
        description: 'Retrieves garbage collector objects',
        returns: '{any} - Array of GC objects',
        category: 'Script',
        examples: ['local gcObjects = getgc()']
    },

    // Additional Debug Functions
    {
        name: 'debug.getconstant',
        signature: 'debug.getconstant(func: function, index: number): any',
        description: 'Returns the constant at index in the function\'s constant table',
        returns: 'any - Constant value',
        category: 'Debug',
        examples: ['local constant = debug.getconstant(func, 1)']
    },
    {
        name: 'debug.setconstant',
        signature: 'debug.setconstant(func: function, index: number, value: any): void',
        description: 'Modifies a constant in the function\'s constant table',
        returns: 'void',
        category: 'Debug',
        examples: ['debug.setconstant(func, 1, "new value")']
    },
    {
        name: 'debug.getupvalue',
        signature: 'debug.getupvalue(func: function, index: number): any',
        description: 'Returns the upvalue at the specified index',
        returns: 'any - Upvalue',
        category: 'Debug',
        examples: ['local upvalue = debug.getupvalue(func, 1)']
    },
    {
        name: 'debug.setupvalue',
        signature: 'debug.setupvalue(func: function, index: number, value: any): void',
        description: 'Sets an upvalue at the specified index',
        returns: 'void',
        category: 'Debug',
        examples: ['debug.setupvalue(func, 1, newValue)']
    },
    {
        name: 'debug.getproto',
        signature: 'debug.getproto(func: function, index: number, active?: boolean): function',
        description: 'Returns nested function prototype at the specified index',
        returns: 'function - Function prototype',
        category: 'Debug',
        examples: ['local proto = debug.getproto(func, 1)']
    },
    {
        name: 'debug.getprotos',
        signature: 'debug.getprotos(func: function): {function}',
        description: 'Returns all nested function prototypes',
        returns: '{function} - Array of prototypes',
        category: 'Debug',
        examples: ['local protos = debug.getprotos(func)']
    },
    {
        name: 'debug.getstack',
        signature: 'debug.getstack(level: number, index?: number): any',
        description: 'Retrieves values from specific stack frames',
        returns: 'any - Stack value',
        category: 'Debug',
        examples: ['local value = debug.getstack(1, 1)']
    },
    {
        name: 'debug.setstack',
        signature: 'debug.setstack(level: number, index: number, value: any): void',
        description: 'Modifies values in stack frames',
        returns: 'void',
        category: 'Debug',
        examples: ['debug.setstack(1, 1, newValue)']
    },

    // Additional Closure Functions
    {
        name: 'clonefunction',
        signature: 'clonefunction(func: function): function',
        description: 'Creates a new closure from an existing function\'s bytecode',
        returns: 'function - Cloned function',
        category: 'Closure',
        examples: ['local cloned = clonefunction(originalFunc)']
    },

    // Additional Misc Functions
    {
        name: 'queue_on_teleport',
        signature: 'queue_on_teleport(code: string): void',
        description: 'Queues code to execute after player teleportation',
        returns: 'void',
        category: 'Misc',
        examples: ['queue_on_teleport("print(\\"Teleported!\\")")']
    },
    {
        name: 'setfpscap',
        signature: 'setfpscap(fps: number): void',
        description: 'Sets the in-game FPS cap. Use 0 to remove the cap.',
        returns: 'void',
        category: 'Misc',
        examples: ['setfpscap(144)', 'setfpscap(0)']
    },
    {
        name: 'lz4compress',
        signature: 'lz4compress(data: string): string',
        description: 'Compresses data using the LZ4 algorithm',
        returns: 'string - Compressed data',
        category: 'Misc',
        examples: ['local compressed = lz4compress("data")']
    },
    {
        name: 'lz4decompress',
        signature: 'lz4decompress(data: string, size: number): string',
        description: 'Decompresses LZ4-compressed data',
        returns: 'string - Decompressed data',
        category: 'Misc',
        examples: ['local decompressed = lz4decompress(compressed, originalSize)']
    },
    {
        name: 'messagebox',
        signature: 'messagebox(text: string, caption: string, flags: number): number',
        description: 'Creates a modal dialog with custom text, title, and flags. Yields until closed.',
        returns: 'number - User response code',
        category: 'Misc',
        examples: ['local result = messagebox("Save changes?", "Confirm", 4)']
    },

    // Filesystem code execution
    {
        name: 'loadfile',
        signature: 'loadfile(path: string, chunkname?: string): function?',
        description: 'Loads a file as a Lua chunk and returns the function',
        returns: 'function? - Loaded function or nil',
        category: 'Filesystem',
        examples: ['local func = loadfile("script.lua")', 'if func then func() end']
    },
    {
        name: 'dofile',
        signature: 'dofile(path: string): void',
        description: 'Loads and executes a file on a new thread',
        returns: 'void',
        category: 'Filesystem',
        examples: ['dofile("autoexec/init.lua")']
    }
];

export const exploitFunctionMap = new Map<string, ExploitFunction>(
    exploitFunctions.map(func => [func.name, func])
);
