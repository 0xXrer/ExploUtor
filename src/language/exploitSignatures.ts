export interface ExploitFunction {
    name: string;
    signature: string;
    description: string;
    returns: string;
    category: string;
    examples?: string[];
}

export const exploitFunctions: ExploitFunction[] = [
    // Environment Functions
    {
        name: 'getgenv',
        signature: 'getgenv(): table',
        description: 'Returns the global environment table for the exploit',
        returns: 'table - The global exploit environment',
        category: 'Environment',
        examples: [
            'getgenv().MyGlobal = "value"',
            'local env = getgenv()'
        ]
    },
    {
        name: 'getrenv',
        signature: 'getrenv(): table',
        description: 'Returns the Roblox global environment',
        returns: 'table - The Roblox environment',
        category: 'Environment',
        examples: ['local renv = getrenv()']
    },
    {
        name: 'getfenv',
        signature: 'getfenv(level: number | function): table',
        description: 'Returns the environment of a function or stack level',
        returns: 'table - The function environment',
        category: 'Environment',
        examples: [
            'local env = getfenv(1)',
            'local env = getfenv(someFunction)'
        ]
    },
    {
        name: 'setfenv',
        signature: 'setfenv(level: number | function, env: table): function',
        description: 'Sets the environment of a function or stack level',
        returns: 'function - The function with updated environment',
        category: 'Environment',
        examples: ['setfenv(1, {})']
    },

    // Hooking Functions
    {
        name: 'hookfunction',
        signature: 'hookfunction(target: function, hook: function): function',
        description: 'Hooks a function, replacing it with a custom implementation. Returns the original function.',
        returns: 'function - The original function before hooking',
        category: 'Hooking',
        examples: [
            'local old = hookfunction(print, function(...) return old("Hooked:", ...) end)'
        ]
    },
    {
        name: 'hookmetamethod',
        signature: 'hookmetamethod(object: userdata, method: string, hook: function): function',
        description: 'Hooks a metamethod of an object. Returns the original metamethod.',
        returns: 'function - The original metamethod',
        category: 'Hooking',
        examples: [
            'local old = hookmetamethod(game, "__namecall", function(self, ...) return old(self, ...) end)'
        ]
    },

    // Script Functions
    {
        name: 'getsenv',
        signature: 'getsenv(script: Instance): table',
        description: 'Returns the environment table of a script',
        returns: 'table - The script environment',
        category: 'Script',
        examples: ['local env = getsenv(game.Players.LocalPlayer.PlayerScripts.Script)']
    },
    {
        name: 'getcallingscript',
        signature: 'getcallingscript(): Instance?',
        description: 'Returns the script that called the current function',
        returns: 'Instance? - The calling script or nil',
        category: 'Script',
        examples: ['local caller = getcallingscript()']
    },
    {
        name: 'getscriptclosure',
        signature: 'getscriptclosure(script: Instance): function',
        description: 'Returns the main function of a script',
        returns: 'function - The script\'s main function',
        category: 'Script',
        examples: ['local func = getscriptclosure(script)']
    },
    {
        name: 'getscripthash',
        signature: 'getscripthash(script: Instance): string',
        description: 'Returns the hash of a script',
        returns: 'string - The script hash',
        category: 'Script',
        examples: ['local hash = getscripthash(script)']
    },
    {
        name: 'getscriptbytecode',
        signature: 'getscriptbytecode(script: Instance): string',
        description: 'Returns the bytecode of a script',
        returns: 'string - The script bytecode',
        category: 'Script',
        examples: ['local bytecode = getscriptbytecode(script)']
    },

    // Instance Functions
    {
        name: 'getnilinstances',
        signature: 'getnilinstances(): {Instance}',
        description: 'Returns all instances with nil parent',
        returns: '{Instance} - Array of nil instances',
        category: 'Instance',
        examples: ['local nilInstances = getnilinstances()']
    },
    {
        name: 'getinstances',
        signature: 'getinstances(): {Instance}',
        description: 'Returns all instances in the game',
        returns: '{Instance} - Array of all instances',
        category: 'Instance',
        examples: ['local allInstances = getinstances()']
    },
    {
        name: 'fireclickdetector',
        signature: 'fireclickdetector(detector: ClickDetector, distance: number?): void',
        description: 'Fires a ClickDetector',
        returns: 'void',
        category: 'Instance',
        examples: ['fireclickdetector(workspace.Part.ClickDetector)']
    },
    {
        name: 'fireproximityprompt',
        signature: 'fireproximityprompt(prompt: ProximityPrompt): void',
        description: 'Fires a ProximityPrompt',
        returns: 'void',
        category: 'Instance',
        examples: ['fireproximityprompt(workspace.Part.ProximityPrompt)']
    },

    // Metatable Functions
    {
        name: 'getrawmetatable',
        signature: 'getrawmetatable(object: any): table?',
        description: 'Returns the raw metatable of an object, bypassing __metatable',
        returns: 'table? - The metatable or nil',
        category: 'Metatable',
        examples: ['local mt = getrawmetatable(game)']
    },
    {
        name: 'setrawmetatable',
        signature: 'setrawmetatable(object: any, metatable: table): void',
        description: 'Sets the raw metatable of an object, bypassing protections',
        returns: 'void',
        category: 'Metatable',
        examples: ['setrawmetatable(game, {})']
    },
    {
        name: 'setreadonly',
        signature: 'setreadonly(table: table, readonly: boolean): void',
        description: 'Sets whether a table is read-only',
        returns: 'void',
        category: 'Metatable',
        examples: [
            'setreadonly(table, false)',
            'setreadonly(getrawmetatable(game), false)'
        ]
    },
    {
        name: 'isreadonly',
        signature: 'isreadonly(table: table): boolean',
        description: 'Checks if a table is read-only',
        returns: 'boolean - True if read-only',
        category: 'Metatable',
        examples: ['local readonly = isreadonly(table)']
    },

    // Closure Functions
    {
        name: 'islclosure',
        signature: 'islclosure(func: function): boolean',
        description: 'Checks if a function is a Lua closure',
        returns: 'boolean - True if Lua closure',
        category: 'Closure',
        examples: ['local isLua = islclosure(function() end)']
    },
    {
        name: 'iscclosure',
        signature: 'iscclosure(func: function): boolean',
        description: 'Checks if a function is a C closure',
        returns: 'boolean - True if C closure',
        category: 'Closure',
        examples: ['local isC = iscclosure(print)']
    },
    {
        name: 'newcclosure',
        signature: 'newcclosure(func: function): function',
        description: 'Wraps a Lua function as a C closure',
        returns: 'function - The wrapped function',
        category: 'Closure',
        examples: ['local wrapped = newcclosure(function() end)']
    },
    {
        name: 'checkcaller',
        signature: 'checkcaller(): boolean',
        description: 'Checks if the current thread is from the executor',
        returns: 'boolean - True if executor thread',
        category: 'Closure',
        examples: ['if checkcaller() then print("Executor thread") end']
    },

    // Utility Functions
    {
        name: 'setclipboard',
        signature: 'setclipboard(content: string): void',
        description: 'Sets the clipboard content',
        returns: 'void',
        category: 'Utility',
        examples: ['setclipboard("Hello, World!")']
    },
    {
        name: 'setfflag',
        signature: 'setfflag(flag: string, value: string): void',
        description: 'Sets a FFlag value',
        returns: 'void',
        category: 'Utility',
        examples: ['setfflag("FlagName", "true")']
    },
    {
        name: 'getfflag',
        signature: 'getfflag(flag: string): string',
        description: 'Gets a FFlag value',
        returns: 'string - The flag value',
        category: 'Utility',
        examples: ['local value = getfflag("FlagName")']
    },

    // File System Functions
    {
        name: 'readfile',
        signature: 'readfile(path: string): string',
        description: 'Reads a file from the workspace folder',
        returns: 'string - The file contents',
        category: 'Filesystem',
        examples: ['local content = readfile("config.txt")']
    },
    {
        name: 'writefile',
        signature: 'writefile(path: string, content: string): void',
        description: 'Writes content to a file',
        returns: 'void',
        category: 'Filesystem',
        examples: ['writefile("data.txt", "Hello")']
    },
    {
        name: 'appendfile',
        signature: 'appendfile(path: string, content: string): void',
        description: 'Appends content to a file',
        returns: 'void',
        category: 'Filesystem',
        examples: ['appendfile("log.txt", "New entry\\n")']
    },
    {
        name: 'isfile',
        signature: 'isfile(path: string): boolean',
        description: 'Checks if a file exists',
        returns: 'boolean - True if file exists',
        category: 'Filesystem',
        examples: ['if isfile("config.txt") then readfile("config.txt") end']
    },
    {
        name: 'isfolder',
        signature: 'isfolder(path: string): boolean',
        description: 'Checks if a folder exists',
        returns: 'boolean - True if folder exists',
        category: 'Filesystem',
        examples: ['if isfolder("data") then print("Folder exists") end']
    },
    {
        name: 'makefolder',
        signature: 'makefolder(path: string): void',
        description: 'Creates a folder',
        returns: 'void',
        category: 'Filesystem',
        examples: ['makefolder("data")']
    },
    {
        name: 'listfiles',
        signature: 'listfiles(path: string): {string}',
        description: 'Lists all files in a folder',
        returns: '{string} - Array of file paths',
        category: 'Filesystem',
        examples: ['local files = listfiles("data")']
    },
    {
        name: 'delfile',
        signature: 'delfile(path: string): void',
        description: 'Deletes a file',
        returns: 'void',
        category: 'Filesystem',
        examples: ['delfile("temp.txt")']
    },
    {
        name: 'delfolder',
        signature: 'delfolder(path: string): void',
        description: 'Deletes a folder',
        returns: 'void',
        category: 'Filesystem',
        examples: ['delfolder("temp")']
    },

    // Network Functions
    {
        name: 'request',
        signature: 'request(options: {Url: string, Method: string?, Headers: table?, Body: string?}): {Success: boolean, StatusCode: number, Body: string, Headers: table}',
        description: 'Makes an HTTP request',
        returns: 'table - Response with Success, StatusCode, Body, and Headers',
        category: 'Network',
        examples: [
            'local response = request({Url = "https://api.example.com", Method = "GET"})'
        ]
    },
    {
        name: 'http_request',
        signature: 'http_request(options: table): table',
        description: 'Alias for request function',
        returns: 'table - HTTP response',
        category: 'Network',
        examples: ['local response = http_request({Url = "https://example.com"})']
    },

    // Debug Functions
    {
        name: 'getinfo',
        signature: 'getinfo(func: function | number): table',
        description: 'Returns debug info about a function',
        returns: 'table - Debug information',
        category: 'Debug',
        examples: ['local info = getinfo(print)']
    },
    {
        name: 'getconstants',
        signature: 'getconstants(func: function): {any}',
        description: 'Returns all constants in a function',
        returns: '{any} - Array of constants',
        category: 'Debug',
        examples: ['local constants = getconstants(func)']
    },
    {
        name: 'getupvalues',
        signature: 'getupvalues(func: function): {any}',
        description: 'Returns all upvalues of a function',
        returns: '{any} - Array of upvalues',
        category: 'Debug',
        examples: ['local upvalues = getupvalues(func)']
    },
    {
        name: 'getconnections',
        signature: 'getconnections(signal: RBXScriptSignal): {Connection}',
        description: 'Returns all connections to a signal',
        returns: '{Connection} - Array of connections',
        category: 'Debug',
        examples: ['local connections = getconnections(workspace.ChildAdded)']
    },

    // Identity Functions
    {
        name: 'getidentity',
        signature: 'getidentity(): number',
        description: 'Returns the current thread identity level',
        returns: 'number - Thread identity (0-8)',
        category: 'Identity',
        examples: ['local identity = getidentity()']
    },
    {
        name: 'setidentity',
        signature: 'setidentity(identity: number): void',
        description: 'Sets the current thread identity level',
        returns: 'void',
        category: 'Identity',
        examples: ['setidentity(8)']
    },
    {
        name: 'getthreadidentity',
        signature: 'getthreadidentity(): number',
        description: 'Alias for getidentity',
        returns: 'number - Thread identity',
        category: 'Identity',
        examples: ['local identity = getthreadidentity()']
    },
    {
        name: 'setthreadidentity',
        signature: 'setthreadidentity(identity: number): void',
        description: 'Alias for setidentity',
        returns: 'void',
        category: 'Identity',
        examples: ['setthreadidentity(7)']
    },

    // Misc Functions
    {
        name: 'loadstring',
        signature: 'loadstring(source: string, chunkname: string?): function?',
        description: 'Loads a string as Lua code and returns a function',
        returns: 'function? - Compiled function or nil on error',
        category: 'Misc',
        examples: [
            'local func = loadstring("print(\\"Hello\\")")',
            'func()'
        ]
    },
    {
        name: 'decompile',
        signature: 'decompile(script: Instance): string',
        description: 'Decompiles a script to Luau source code',
        returns: 'string - Decompiled source',
        category: 'Misc',
        examples: ['local source = decompile(script)']
    },
    {
        name: 'saveinstance',
        signature: 'saveinstance(options: table?): void',
        description: 'Saves the game instance to a file',
        returns: 'void',
        category: 'Misc',
        examples: ['saveinstance()']
    },
    {
        name: 'getnamecallmethod',
        signature: 'getnamecallmethod(): string',
        description: 'Returns the method name from a __namecall metamethod',
        returns: 'string - The method name',
        category: 'Misc',
        examples: [
            'local old = hookmetamethod(game, "__namecall", function(self, ...) print(getnamecallmethod()) return old(self, ...) end)'
        ]
    },
    {
        name: 'identifyexecutor',
        signature: 'identifyexecutor(): string',
        description: 'Returns the name of the executor',
        returns: 'string - Executor name',
        category: 'Misc',
        examples: ['local executor = identifyexecutor()']
    }
];

export const exploitFunctionMap = new Map<string, ExploitFunction>(
    exploitFunctions.map(func => [func.name, func])
);
