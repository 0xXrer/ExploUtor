{
  "Hook Function": {
    "prefix": "hookfunc",
    "body": [
      "local old${1:FunctionName}",
      "old${1:FunctionName} = hookfunction(${2:target}, function(...)",
      "\tif not checkcaller() then",
      "\t\treturn old${1:FunctionName}(...)",
      "\tend",
      "\t",
      "\tlocal args = {...}",
      "\t$0",
      "\treturn old${1:FunctionName}(...)",
      "end)"
    ],
    "description": "Hook a function with checkcaller bypass"
  },
  "Hook Metamethod": {
    "prefix": "hookmeta",
    "body": [
      "local old${1:Metamethod}",
      "old${1:Metamethod} = hookmetamethod(game, \"__${2:index}\", newcclosure(function(self, ...)",
      "\tif not checkcaller() then",
      "\t\treturn old${1:Metamethod}(self, ...)",
      "\tend",
      "\t",
      "\tlocal args = {...}",
      "\t$0",
      "\treturn old${1:Metamethod}(self, ...)",
      "end))"
    ],
    "description": "Hook a metamethod with newcclosure protection"
  },
  "Hook NameCall": {
    "prefix": "hooknamecall",
    "body": [
      "local oldNamecall",
      "oldNamecall = hookmetamethod(game, \"__namecall\", newcclosure(function(self, ...)",
      "\tlocal method = getnamecallmethod()",
      "\t",
      "\tif not checkcaller() then",
      "\t\treturn oldNamecall(self, ...)",
      "\tend",
      "\t",
      "\tif method == \"${1:FireServer}\" then",
      "\t\t$0",
      "\tend",
      "\t",
      "\treturn oldNamecall(self, ...)",
      "end))"
    ],
    "description": "Hook __namecall with protection"
  },
  "New C Closure": {
    "prefix": "newcclosure",
    "body": [
      "newcclosure(function(...)",
      "\t$0",
      "end)"
    ],
    "description": "Wrap function in C closure for anti-detection"
  },
  "Protect Table": {
    "prefix": "protect",
    "body": [
      "local ${1:tbl} = {}",
      "setreadonly(${1:tbl}, false)",
      "",
      "local mt = {",
      "\t__index = function(self, key)",
      "\t\tif not checkcaller() then",
      "\t\t\terror(\"Access denied\")",
      "\t\tend",
      "\t\treturn rawget(self, key)",
      "\tend,",
      "\t__newindex = function(self, key, value)",
      "\t\tif not checkcaller() then",
      "\t\t\terror(\"Access denied\")",
      "\t\tend",
      "\t\trawset(self, key, value)",
      "\tend,",
      "\t__metatable = \"Locked\"",
      "}",
      "",
      "setmetatable(${1:tbl}, mt)"
    ],
    "description": "Create a protected table"
  },
  "Get Global Env": {
    "prefix": "getgenv",
    "body": [
      "local env = getgenv()",
      "if not env.${1:MyLibrary} then",
      "\tenv.${1:MyLibrary} = {}",
      "end",
      "local ${1:MyLibrary} = env.${1:MyLibrary}"
    ],
    "description": "Safely get/init global environment"
  },
  "Spoof Instance": {
    "prefix": "spoof",
    "body": [
      "local oldIndex",
      "oldIndex = hookmetamethod(game, \"__index\", newcclosure(function(self, key)",
      "\tif checkcaller() then return oldIndex(self, key) end",
      "\t",
      "\tif self == ${1:TargetInstance} and key == \"${2:Property}\" then",
      "\t\treturn ${3:SpoofedValue}",
      "\tend",
      "\t",
      "\treturn oldIndex(self, key)",
      "end))"
    ],
    "description": "Spoof instance property"
  },
  "Remote Spy Template": {
    "prefix": "remotespy",
    "body": [
      "local oldNamecall",
      "oldNamecall = hookmetamethod(game, \"__namecall\", newcclosure(function(self, ...)",
      "\tlocal method = getnamecallmethod()",
      "\tlocal args = {...}",
      "\t",
      "\tif method == \"FireServer\" or method == \"InvokeServer\" then",
      "\t\tprint(\"Remote: \" .. self.Name .. \" | Method: \" .. method)",
      "\t\tfor i, v in ipairs(args) do",
      "\t\t\tprint(\"Arg \" .. i .. \": \" .. tostring(v))",
      "\t\tend",
      "\tend",
      "\t",
      "\treturn oldNamecall(self, ...)",
      "end))"
    ],
    "description": "Simple remote spy"
  },
  "Bypass Anti-Cheat": {
    "prefix": "bypassac",
    "body": [
      "local oldNamecall",
      "oldNamecall = hookmetamethod(game, \"__namecall\", newcclosure(function(self, ...)",
      "\tlocal method = getnamecallmethod()",
      "\t",
      "\tif method == \"FireServer\" and self.Name == \"${1:BanRemote}\" then",
      "\t\treturn",
      "\tend",
      "\t",
      "\treturn oldNamecall(self, ...)",
      "end))"
    ],
    "description": "Block specific remote calls"
  },
  "Clone Function": {
    "prefix": "clonefunc",
    "body": [
      "local ${1:newFunc} = clonefunction(${2:targetFunc})"
    ],
    "description": "Clone a function to avoid detection"
  },
  "Secure Call": {
    "prefix": "securecall",
    "body": [
      "local function secureCall(func, ...)",
      "\tlocal success, result = pcall(func, ...)",
      "\tif not success then",
      "\t\twarn(\"Secure call failed:\", result)",
      "\t\treturn nil",
      "\tend",
      "\treturn result",
      "end"
    ],
    "description": "Safe function execution wrapper"
  },
  "Drawing Library": {
    "prefix": "drawing",
    "body": [
      "local ${1:obj} = Drawing.new(\"${2:Square}\")",
      "${1:obj}.Visible = true",
      "${1:obj}.Color = Color3.fromRGB(255, 255, 255)",
      "${1:obj}.Transparency = 1",
      "${1:obj}.Thickness = 1",
      "$0"
    ],
    "description": "Create drawing object"
  }
}